#! /usr/bin/env ruby

require 'socket'
require 'FileUtils'
require 'pathname'
require 'rutui'


socket_path = "/tmp/work_console.sock"

at_exit { FileUtils.rm socket_path }

server = UNIXServer.new(socket_path)
screen = RuTui::Screen.new

Socket.accept_loop(server) do |socket, _addr|
  screen.rescreen
  screen.add_static RuTui::Text.new(x: 1, y: 1, text: socket.read)
  socket.close
  #require 'pry';binding.pry
  screen.draw
end
